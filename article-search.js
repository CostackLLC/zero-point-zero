var toggleSearchSlidePanel,searchSlidePanel,searchOverlay,imageWrappers;function initializeSearchPanel(){searchSlidePanel=document.getElementById("article-search-panel"),searchOverlay=document.getElementById("article-search-overlay"),imageWrappers=document.querySelectorAll(".article-left-view-image-wrapper"),clearButton=document.querySelector(".aa-Autocomplete .aa-ClearButton"),inputField=document.querySelector("#autocomplete input"),searchSlidePanel&&searchOverlay&&clearButton&&inputField?(toggleSearchSlidePanel=function(){requestAnimationFrame((function(){searchSlidePanel.classList.contains("show")?(inputField.value&&clearButton.click(),setTimeout((function(){searchSlidePanel.classList.remove("show"),searchOverlay.classList.remove("show"),imageWrappers.forEach((function(e){e.classList.remove("greyscale")})),inputField.blur()}),500)):(searchSlidePanel.classList.add("show"),searchOverlay.classList.add("show"),imageWrappers.forEach((function(e){e.classList.add("greyscale")})))}))},searchSlidePanel.addEventListener("transitionend",(function(){searchSlidePanel.classList.contains("show")&&inputField.focus()})),document.getElementById("article-search-button").addEventListener("click",toggleSearchSlidePanel),clearButton.addEventListener("click",(function(){setTimeout((function(){searchSlidePanel.classList.remove("show"),searchOverlay.classList.remove("show"),imageWrappers.forEach((function(e){e.classList.remove("greyscale")})),inputField.blur()}),500)})),document.addEventListener("keydown",(function(e){"Escape"!==e.key&&27!==e.keyCode||!searchSlidePanel.classList.contains("show")||(inputField.value&&clearButton.click(),setTimeout((function(){searchSlidePanel.classList.remove("show"),searchOverlay.classList.remove("show"),imageWrappers.forEach((function(e){e.classList.remove("greyscale")})),inputField.blur()}),500))}))):console.error("One or more elements could not be found in the DOM.")}document.addEventListener("DOMContentLoaded",(function(){var e=new MutationObserver((function(e,a){var i=document.querySelector(".aa-Form");if(i){i.appendChild(n);var l=document.querySelector(".close-button");l&&(l.removeEventListener("click",t),l.addEventListener("click",t)),a.disconnect()}}));function t(){toggleSearchSlidePanel(),inputField.blur(),inputField.value=""}e.observe(document.body,{childList:!0,subtree:!0});var n=document.createElement("div");n.setAttribute("class","close-button-container");var a=document.createElement("button");a.setAttribute("class","close-button");var i=document.createElementNS("http://www.w3.org/2000/svg","svg");i.setAttribute("viewBox","0 0 24 24"),i.setAttribute("fill","rgba(255, 255, 255, 0.45)");var l=document.createElementNS("http://www.w3.org/2000/svg","path");l.setAttribute("d","M5.293 6.707l5.293 5.293-5.293 5.293c-0.391 0.391-0.391 1.024 0 1.414s1.024 0.391 1.414 0l5.293-5.293 5.293 5.293c0.391 0.391 1.024 0.391 1.414 0s0.391-1.024 0-1.414l-5.293-5.293 5.293-5.293c0.391-0.391 0.391-1.024 0-1.414s-1.024-0.391-1.414 0l-5.293 5.293-5.293-5.293c-0.391-0.391-1.024-0.391-1.414 0s-0.391 1.024 0 1.414z"),i.appendChild(l),a.appendChild(i),n.appendChild(a);var r=document.querySelector(".aa-ClearButton");r&&(r.textContent="CLEAR");var s=new MutationObserver((function(e){e.forEach((function(e){"hidden"===e.attributeName&&(n.style.display=r.hasAttribute("hidden")?"block":"none")}))}));r&&s.observe(r,{attributes:!0}),document.addEventListener("click",(function(e){var t=document.querySelector(".aa-Autocomplete"),n=document.querySelector(".aa-Panel"),a=!!t&&t.contains(e.target),i=!!n&&n.contains(e.target);a||i||!searchSlidePanel.classList.contains("show")||(inputField.value&&r.click(),setTimeout((function(){searchSlidePanel.classList.remove("show"),searchOverlay.classList.remove("show"),imageWrappers.forEach((function(e){e.classList.remove("greyscale")})),inputField.blur()}),500))})),initializeSearchPanel()}));var clearButton,inputField=document.querySelector(".aa-Input"),wrapperDiv=document.querySelector(".aa-InputWrapper"),newDiv=document.createElement("div");function updateContent(){for(var e=inputField.selectionStart,t=inputField.value,n="",a=0;a<t.length;a++){var i=t[a];n+=`<span class="${a===e-1?"letter caret":"letter"}">${i=" "===i?" ":i}</span>`}0===e&&t?n=n.replace('<span class="letter">','<span class="letter caret">'):0!==e||t||(n='<span class="letter caret"> </span>'),newDiv.innerHTML=n,newDiv.scrollLeft=newDiv.scrollWidth}function scrollDiv(e){var t=document.querySelector(".aa-Panel--scrollable");t&&(t.scrollTop+=e.deltaY)}newDiv.contentEditable="true",newDiv.className="editableDiv",newDiv.style.position="absolute",newDiv.style.width="100%",newDiv.style.display="flex",newDiv.style.pointerEvents="none",newDiv.style.overflow="hidden",wrapperDiv.appendChild(newDiv),inputField.addEventListener("input",updateContent),inputField.addEventListener("keydown",(function(e){["ArrowLeft","ArrowRight","Home","End"].includes(e.key)&&setTimeout(updateContent,0),"ArrowRight"===e.key&&0===inputField.selectionStart&&(inputField.selectionStart=inputField.selectionEnd=1)})),inputField.addEventListener("click",updateContent),inputField.addEventListener("focus",updateContent),(clearButton=document.querySelector(".aa-ClearButton")).addEventListener("click",(function(){newDiv.innerHTML='<span class="letter caret"> </span>',inputField.value=""})),document.addEventListener("DOMContentLoaded",updateContent),inputField.addEventListener("focus",(function(){inputField.value||(newDiv.innerHTML='<span class="letter caret"> </span>')})),document.addEventListener("DOMContentLoaded",(e=>{const t=document.querySelector(".aa-SubmitButton");if(t){const e=document.createElement("div");e.className=t.className,e.innerHTML=t.innerHTML,t.parentNode.insertBefore(e,t),t.parentNode.removeChild(t)}})),document.addEventListener("wheel",scrollDiv);